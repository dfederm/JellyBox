<ResourceDictionary
    x:Class="JellyBox.Resources.Templates"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Interactivity="using:Microsoft.Xaml.Interactivity"
    xmlns:Behaviors="using:JellyBox.Behaviors"
    xmlns:controls="using:JellyBox.Controls"
    xmlns:models="using:JellyBox.Models">

    <DataTemplate x:Key="Section" x:DataType="models:Section">
        <StackPanel
            Visibility="{x:Bind Cards, Converter={StaticResource EmptyCollectionToVisibilityConverter}}"
            Margin="0,0,0,8">
            <TextBlock
                Margin="48,0,48,0"
                Padding="0,0,0,8"
                HorizontalAlignment="Left"
                FontSize="{StaticResource FontL}"
                FontWeight="SemiBold"
                Foreground="{StaticResource TextPrimary}"
                Text="{x:Bind Name}" />
            <ListView
                Padding="48,0,48,0"
                IsItemClickEnabled="True"
                IsTabStop="False"
                ItemsSource="{x:Bind Cards}"
                ItemTemplate="{StaticResource Card}"
                ItemContainerStyle="{StaticResource CardListViewItemStyle}"
                ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                ScrollViewer.HorizontalScrollMode="Enabled"
                ScrollViewer.VerticalScrollMode="Disabled"
                SelectionMode="None"
                SingleSelectionFollowsFocus="False"
                TabNavigation="Once"
                XYFocusKeyboardNavigation="Enabled">
                <Interactivity:Interaction.Behaviors>
                    <Behaviors:ListViewBaseCommandBehavior />
                    <Behaviors:ScrollOnFocusBehavior SafeZoneMargin="52" />
                </Interactivity:Interaction.Behaviors>
                <ListView.ItemsPanel>
                    <ItemsPanelTemplate>
                        <!-- Right margin adds scrollable space so last items can be scrolled into safe zone -->
                        <StackPanel Orientation="Horizontal" Spacing="4" Margin="0,0,48,0" />
                    </ItemsPanelTemplate>
                </ListView.ItemsPanel>
            </ListView>
        </StackPanel>
    </DataTemplate>

    <DataTemplate x:Key="Card" x:DataType="models:Card">
        <Grid Padding="8">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Border
                CornerRadius="{StaticResource CardCornerRadius}"
                Background="{StaticResource BackgroundCard}">
                <controls:LazyLoadedImage
                    ImageUri="{x:Bind Image.Uri}"
                    BlurHash="{x:Bind Image.BlurHash}"
                    Width="{x:Bind ImageWidth}"
                    Height="{x:Bind ImageHeight}" />
            </Border>
            <TextBlock
                Grid.Row="1"
                Text="{x:Bind Name}"
                TextAlignment="Center"
                TextTrimming="CharacterEllipsis"
                MaxLines="2"
                Foreground="{StaticResource TextSecondary}"
                FontSize="{StaticResource FontS}"
                Padding="4,10,4,10"
                MaxWidth="{x:Bind ImageWidth}" />
        </Grid>
    </DataTemplate>
</ResourceDictionary>
